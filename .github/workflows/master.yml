name: Human-like Daily Commit

on:
  schedule:
    - cron: '17 2 * * *'   # jam acak-ish (02:17 UTC)
  workflow_dispatch:

permissions:
  contents: write

jobs:
  daily_commit:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          persist-credentials: true
          fetch-depth: 0

      - name: Simulate Human Activity
        run: |
          git config user.email "220705058@student.ar-raniry.ac.id"
          git config user.name "SyukurGit"

          rand=$((RANDOM % 100))

          if [ $rand -lt 5 ]; then
            echo "Hari ini kosong (jarang banget) ðŸ•³ï¸"
            exit 0
          elif [ $rand -lt 55 ]; then
            commit_count=$(( (RANDOM % 2) + 1 ))
            echo "Hari ringan: $commit_count commit ðŸŒ±"
          elif [ $rand -lt 85 ]; then
            commit_count=$(( (RANDOM % 3) + 3 ))
            echo "Hari sedang: $commit_count commit ðŸŒ¿"
          else
            commit_count=$(( (RANDOM % 7) + 8 ))
            echo "Hari berat: $commit_count commit ðŸŒ³"
          fi

          commit_messages=(
            "Minor cleanup"
            "Small adjustment"
            "Refactor snippet"
            "Update logic"
            "Improve flow"
            "Fix formatting"
            "Optimize part"
          )

          for i in $(seq 1 $commit_count); do
            sleep_time=$(( (RANDOM % 180) + 60 )) # 1â€“4 menit
            sleep $sleep_time

            current_time=$(date '+%Y-%m-%d %H:%M:%S')
            msg=${commit_messages[$RANDOM % ${#commit_messages[@]}]}

            echo "$msg at $current_time" > daily_activity.log

            git add daily_activity.log
            git commit -m "$msg ($current_time)" || true
          done

          git push origin master
